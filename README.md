# ElatisearchStudy
## 背景
  主要简介项目背景，应用场景，为何分享
## 目的
  回答上述为何分享问题，描述作用，优缺点
  eg. 作为一个nosql存储
## 内容
  需要丰满的内容（对此处的知识储备要求达标）
  eg. 倒排索引，分词器，数据结构；
      为何这么设计等
## 对比
  与各个技术相比较，做个简答对比
  eg. MongoDB haddoop （大数据级别对比，从可用性，维护性，）
  
  RediSearch + RedisJSON = 王炸
  索引能力：560万文档（5.3GB） RediSearch ：221s   ES：349
  查询能力：32个客户端对两个单词检索：
                              RediSearch: 12.5K ops/sec  ES: 3.1K ops/sec
                              延迟：RediSearch 8ms ES: 10ms
  
## 什么是全文检索
### 数据分类
* 结构化数据：固定格式，有限长度  如mysql存储的数据
* 非结构化数据：不确定的长度，无固定格式 如邮箱，word文档，日志
* 半结构化数据：前两者的结合：如xml，html
### 搜索分类
* 结构化数据搜索：关系型数据库
* 非结构化数据搜索：
- 顺序扫描
- 全文检索
设搜索场景如下：
| name | content | author
__
|静夜思|床前明月光，疑似地上霜。举头望明月，低头思故乡。
|望庐山瀑布|日照香炉生紫烟，遥看瀑布挂前川。飞流直下三千尺，疑是银河落九天。|
|登鹤雀楼|白日依山尽，黄河入海流。欲穷千里目，更上一层楼。|
|...|...|...|

思考：使用传统关系数据库和ES实现会有什么差别？
若是MYSQL存储，需要些查询的SQL：
````sql 
select name from poems where content like '%前%'
````sql 
这种我们称为顺序扫描法，需要遍历所有的记录进行匹配。不但效率低，而且不符合我的搜索时的期望，比如：搜索“ABCD”的关键词，还希望看到“A”，“AB”，“CD”，“ABC”的搜说结果。
### 全文检索是指：
  1. 通过一个程序扫描文本中的每一个单词，针对单词建立索引，并保存该单词在文本中的位置、以及出现的次数
  2. 用户查询时，通过建立好的索引来查询，将索引中单词对应的文本位置、出现的次数返回给用户，因为有了具体文本的位置，所以就可以将具体内容读取出来。
搜索原理：
* 内容爬取，停顿词过滤比如像一些无用的  “的”  “了”之类的语气词/连接词
* 内容分词，提取关键词
* 根据关键词建立倒排索引
* 用户输入关键词进行搜索
####倒排索引
索引类似于目录，通过主键定位到某条数据；而倒排索引刚好相反，数据对应到主键。
倒排索引建立过程：
数据： "你好"  "你妈"   "你爸"

| id | word | index |
--
| 1 | 你 | 1 |
| 2 | 你 | 2 |
| 3 | 你 | 3 |
| 4 | 好 | 1 |
| 5 | 妈 | 2 |
| 6 | 爸 | 3 |


去重 ------
| id | word | index |
--
| 1 | 你 | 1,2,3 |
| 4 | 好 | 1 |
| 5 | 妈 | 2 |
| 6 | 爸 | 3 |

排序：
| id | word | index |
--
| 1 | 爸 | 3 |
| 2 | 好 | 1 |
| 3 | 妈 | 2 |
| 4 | 你 | 1,2,3 |



### 正排索引
通过ID找到这条记录



## 结尾
  进一步总结
  eg. 收获

